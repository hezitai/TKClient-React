/*! author:Mr Qiu , date:2018-12-25 */

!function(){window.clientInfo=window.clientInfo||{};var p=!1,u=!1,y=!1,e=window.GLOBAL.getUrlParams("endtype"),t=void 0,l=void 0,a=window.location.protocol+"//"+(window.GLOBAL.getUrlParams("host")?window.GLOBAL.getUrlParams("host"):window.location.hostname)+"/ClientAPI/getupdateinfo?ts="+(new Date).getTime(),n=navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||navigator.language,w=n&&n.toLowerCase().match(/zh/g)?"chinese":"english";if(window.GLOBAL.NativeInfo){var o=window.GLOBAL.NativeInfo();o&&"object"==typeof o?(t=Number(o.endtype),l=Number(o.clientversion)):""!==e&&(t=Number(e),l=""!==window.GLOBAL.getUrlParams("clientversion")?Number(window.GLOBAL.getUrlParams("clientversion")):2018010200)}else""!==e&&(t=Number(e),l=""!==window.GLOBAL.getUrlParams("clientversion")?Number(window.GLOBAL.getUrlParams("clientversion")):2018010200);function s(t,e,n,o){var i=window.publishDirFix||"./",l=document.createElement("div");l.style.background="rgb(18, 26, 44)",l.style.position="absolute",l.style.top=0,l.style.left=0,l.style.width="100%",l.style.height="100%",l.style.display=p?"block":"none";var a=document.createElement("div");a.style.width="300px",a.style.height="400px",a.style.position="absolute",a.style.left=0,a.style.right=0,a.style.top=0,a.style.bottom=0,a.style.background="#5790ef",a.style.borderRadius="10px",a.style.backgroundImage="url("+i+"/img/update_bg.jpg)",a.style.backgroundRepeat="no-repeat",a.style.backgroundSize="100% 100%",a.style.margin="auto",a.style.zIndex=99999999,a.style.overflow="hidden",a.style.fontFamily="Microsoft YaHei",a.style.display=u?"block":"none";var s=document.createElement("p");s.style.width="100%",s.style.marginTop="190px",s.style.textAlign="center",s.style.fontSize="25px",s.style.fontWeight="900",s.textContent="chinese"===w?"发现新版本":"found new versions",a.appendChild(s);var d=document.createElement("p");d.style.width="80%",d.style.marginLeft="10%",d.style.marginTop="10px",d.style.fontSize="14px",d.style.textAlign="center","chinese"===w?2===Number(e)?d.textContent="已有新版本可用，为了达到最佳使用体验，建议您立即完成版本升级。":1===Number(e)?d.textContent="已有新版本可用，为了获得完整的学习体验，请您立即完成版本升级。":2===Number(e)&&window.clientInfo.clientversion<=2018122e3&&(d.textContent="已有新版本可用，为了获得完整的学习体验，请您立即完成版本升级。"):2===Number(e)?d.textContent="A new version is available, and for the best use experience, it is recommended that you complete the version upgrade immediately.":1===Number(e)?d.textContent="The new version is available, so to get the full learning experience, please do your version upgrade immediately.":2===Number(e)&&window.clientInfo.clientversion<=2018122e3&&(d.textContent="The new version is available, so to get the full learning experience, please do your version upgrade immediately."),a.appendChild(d);var r=document.createElement("button");r.style.width="20px",r.style.height="20px",r.style.position="absolute",r.style.right="10px",r.style.top="10px",r.style.backgroundImage="url("+i+"/img/update_cancel.png)",r.style.backgroundRepeat="no-repeat",r.style.backgroundSize="100% 100%",r.onclick=function(){l.style.display="none",a.style.display="none",t()},r.style.display=y?"block":"none",a.appendChild(r);var c=document.createElement("button");c.style.width="40%",c.style.height="10%",c.style.position="absolute",c.style.left="30%",c.style.bottom="10%",c.style.backgroundImage="url("+i+"/img/update_affirm.jpg)",c.style.backgroundRepeat="no-repeat",c.style.backgroundSize="100% 100%",c.style.fontSize="16px",c.style.color="white",c.textContent="chinese"===w?"立即升级":"Upgrade Now",c.onclick=function(){l.style.display="none",a.style.display="none";var e={};e.updateaddr=n,e.setupaddr=o,talk_window?talk_window.updateClient(e):(console.error("talk_window is not exist!"),t&&"function"==typeof t&&t())},a.appendChild(c),l.appendChild(a),document.getElementsByTagName("body")[0].appendChild(l)}function d(t,e,n,o){var i=window.publishDirFix||"./",l=document.createElement("div");l.style.background="rgb(18, 26, 44)",l.style.position="absolute",l.style.top=0,l.style.left=0,l.style.width="100%",l.style.height="100%";var a=document.createElement("div");a.style.width="100%",a.style.height="100%",a.style.position="absolute",a.style.left=0,a.style.right=0,a.style.top=0,a.style.bottom=0,a.style.background="#5790ef",0===Number(window.clientInfo.endtype)&&window.clientInfo.clientversion<=2018011800?a.style.backgroundImage="url("+i+"/img/xxwjy_TV.jpg)":a.style.backgroundImage="url("+i+"/img/update_bg.jpg)",a.style.backgroundRepeat="no-repeat",a.style.backgroundSize="100% 100%",a.style.margin="auto",a.style.fontFamily="Microsoft YaHei",a.style.zIndex=99999999;var s=document.createElement("p");s.style.width="80%",s.style.position="absolute",s.style.top="50%",s.style.left="10%",s.style.textAlign="center",0===Number(window.clientInfo.endtype)&&window.clientInfo.clientversion<=2018011800?s.style.fontSize="25px":s.style.fontSize="12px",s.style.fontWeight="900",s.textContent="chinese"===w?"您的当前版本过低，请手动下载安装客户端后进入教室":"Your current version is lower, please manually download the installation client ,before enter the classroom",a.appendChild(s);var d=document.createElement("p");d.style.width="80%",d.style.position="absolute",d.style.left="10%",d.style.top="65%",d.style.textAlign="center",0===Number(window.clientInfo.endtype)&&window.clientInfo.clientversion<=2018011800?d.style.fontSize="25px":d.style.fontSize="12px",d.style.color="#478be4",d.style.wordBreak="break-all",d.textContent=o,a.appendChild(d);var r=document.createElement("button");r.style.width="40%",r.style.height="10%",r.style.position="absolute",r.style.left="30%",r.style.bottom="5%",r.style.backgroundImage="url("+i+"/img/update_affirm.jpg)",r.style.backgroundRepeat="no-repeat",r.style.backgroundSize="100% 100%",0===Number(window.clientInfo.endtype)&&window.clientInfo.clientversion<=2018011800?r.style.fontSize="25px":r.style.fontSize="12px",r.style.color="white",r.style.border="none",r.textContent="chinese"===w?"复制连接":"Copy Link",r.onclick=function(){if(talk_window){var e=document.createElement("input");r.textContent="chinese"===w?"已复制":"Copied",e.value=o,document.body.appendChild(e),e.select(),document.execCommand("Copy"),e.style.display="none"}else console.error("talk_window is not exist!"),t&&"function"==typeof t&&t()},a.appendChild(r),l.appendChild(a),document.getElementsByTagName("body")[0].appendChild(l)}window.clientInfo.isClient=1===t||2===t,window.clientInfo.endtype=t,window.clientInfo.clientversion=l,window.checkClientUpdate=function(t,e,n){var o;if(e=e||a,n=n||{},!(window.clientInfo.isClient||0===Number(window.clientInfo.endtype)&&window.clientInfo.clientversion<=2018011800))return console.error("checkClientUpdate must is client!"),void t();if(2===window.clientInfo.endtype)return console.warn("mac client is not checkClientUpdate!"),void t();if(n.type=talk_window&&talk_window.customcategory?Number(talk_window.customcategory):1===window.clientInfo.endtype?1:2===window.clientInfo.endtype?0:void 0,n.version=l,n.companydomain=talk_window&&talk_window.companydomain?talk_window.companydomain:"",void 0===n.type||!n.version)return console.warn("checkClientUpdate options.endtype or options.clientversion is not exist!"),void t();for(var i in o=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),n)e+="&"+i+"="+n[i];o.open("get",e),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.send(),o.onreadystatechange=function(){if(4==o.readyState)if(200===o.status){var e=JSON.parse(o.responseText);if(-1===Number(e.result))return void t();window.clientInfo.clientversion<=2018011800&&talk_window&&(8===Number(talk_window.customcategory)||7===Number(talk_window.customcategory))?d(t,e.updateflag,e.updateaddr,e.setupaddr):!talk_window||!talk_window.updateClient||Number(talk_window.clientversion)<2018122e3?1===Number(e.updateflag)||2===Number(e.updateflag)&&window.clientInfo.clientversion<=2018122e3?d(t,e.updateflag,e.updateaddr,e.setupaddr):t():(2===Number(e.updateflag)&&window.clientInfo.clientversion<=2018122e3&&(y=!(u=p=!0),s(t,e.updateflag,e.updateaddr,e.setupaddr)),0===Number(e.updateflag)?(y=u=p=!1,t()):1===Number(e.updateflag)?(y=!(u=p=!0),s(t,e.updateflag,e.updateaddr,e.setupaddr)):2===Number(e.updateflag)&&(u=p=!0,y=!(window.clientInfo.clientversion<2018122e3),s(t,e.updateflag,e.updateaddr,e.setupaddr)))}else t()}}}();